
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SVD for Image Compression &#8212; MFDS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'SVD_image_compression';</script>
    <link rel="icon" href="_static/fum-logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Comparison of LDA and PCA" href="plot_pca_vs_lda.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fum-cs-logo.png" class="logo__image only-light" alt="MFDS - Home"/>
    <script>document.write(`<img src="_static/fum-cs-logo.png" class="logo__image only-dark" alt="MFDS - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Mathematical Foundations of Data Science Course website
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="SAT_Table.html">SAT-Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="NQueen.html">N-Queen Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_01_intro.html">Images as high dimensional data</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_02_seg_k-means.html">Image Segmentaion</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_03_seg_coords.html">Add coordinates as spatial features to clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="BF-clustering.html">Brute force search clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="k-means-clustering.html">k-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="high_dim_and_CD.html">High Dimensional Data &amp; the curse of dimensionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="high_dim_and_KNN.html">kNN in high dimensional spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="image-clustering_HC.html">Image segmentation by hierarchical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_clustering.html">Images Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="kmeans-clustering-iris.html">IRIS Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="LVQ.html">Vector Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bias-Variance-Tradeoff.html">Bias-Variance Tradeoff</a></li>
<li class="toctree-l1"><a class="reference internal" href="Silhouette-clustering.html">Clustering validation: Silhouette</a></li>
<li class="toctree-l1"><a class="reference internal" href="PCA_01.html">PCA - Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="PCA_02.html">PCA - Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_pca_vs_lda.html">Comparison of LDA and PCA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">SVD for Image Compression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/fum-cs/mfds/blob/main/notebooks/SVD_image_compression.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fum-cs/mfds" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fum-cs/mfds/issues/new?title=Issue%20on%20page%20%2FSVD_image_compression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/SVD_image_compression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SVD for Image Compression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-installation-of-jupyter">A note on installation of jupyter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#montecarlo-calculation-of-pi">Montecarlo calculation of <span class="math notranslate nohighlight">\(\pi\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svd-and-image-compression">SVD and Image compression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skimage-image-processing-library">skimage image processing library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svd-in-python">svd in python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compress-gray-scale-images">Compress gray scale images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-color-images">Load color images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compress-color-images">Compress color images</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape-method-to-compress-a-color-image">Reshape method to compress a color image</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layers-method-to-compress-color-images">Layers method to compress color images</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="" src="_images/banner.png" /></p>
<script src="require.js"></script><section class="tex2jax_ignore mathjax_ignore" id="svd-for-image-compression">
<h1>SVD for Image Compression<a class="headerlink" href="#svd-for-image-compression" title="Permalink to this heading">#</a></h1>
<p><strong>Mahmood Amintoosi, Fall 2024</strong></p>
<p>Computer Science Dept, Ferdowsi University of Mashhad</p>
<p><a class="reference external" href="http://jupyter.org/">Jupyter</a> is an interactive browser based notebook environment where we can combine text, code execution and visualization. It supports multiple programming languages through it’s language specific kernel plugins. However, it is widely used with Python in scientific computing and data science communities. The availability of large number of high quality open source libraries useful for many tasks in scientific computing,numerical linear algebra, machine learning and visualization ensures that Python is being widely used in these fields. Jupyter notebooks are an excellent environment for learning and teaching because of the interactivity.</p>
<p>In this short blogpost, I will explore few topics to illustrate the interactivity of the jupyter environment and the  availability of high quality libraries in the python ecosystem.</p>
<ul class="simple">
<li><p>Montecarlo calculation of <span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p>Image Compression using Singular value decomposition</p></li>
</ul>
<section id="a-note-on-installation-of-jupyter">
<h2>A note on installation of jupyter<a class="headerlink" href="#a-note-on-installation-of-jupyter" title="Permalink to this heading">#</a></h2>
<p>Installation of jupyter and other important packages individually is cumbersome. Thanks to <a class="reference external" href="https://www.anaconda.com/products/individual">Anaconda</a> we have Anaconda python distribution in which almost all of the useful packages are bundled. Install anaconda.</p>
<p>But it is even better not setting up any python environment at all on your computer. Instead, you can use free online python environments- <a class="reference external" href="https://colab.research.google.com/">colab notebooks</a> from google or <a class="reference external" href="https://studiolab.sagemaker.aws/">sagemaker studio lab notebook</a> from aws. Watch <a class="reference external" href="https://www.youtube.com/watch?v=SP-WBt2b54o">this video</a> from the twitter user <a class="reference external" href="https://twitter.com/1littlecoder">1littlecoder</a> on getting started with sagemaker studio lab.</p>
</section>
<section id="montecarlo-calculation-of-pi">
<h2>Montecarlo calculation of <span class="math notranslate nohighlight">\(\pi\)</span><a class="headerlink" href="#montecarlo-calculation-of-pi" title="Permalink to this heading">#</a></h2>
<p>I had earlier written about calculating the mathematical constant <span class="math notranslate nohighlight">\(\pi\)</span> using <a class="reference external" href="https://medium.com/&#64;rameshputalapattu/life-of-pi-a-gophers-tale-2e6922b80792">montecarlo method</a>. It involves generating random points on a unit square and counting the number of points inside the unit quarter circle. We will write a function <code class="docutils literal notranslate"><span class="pre">mc_pi</span></code> to calculate <span class="math notranslate nohighlight">\(\pi\)</span>. In that function, we will also visualize the process of montecarlo simulation using matplotlib library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This line is required to display visualizations in the browser</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mc_pi</span><span class="p">(</span><span class="n">ntrials</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calculate the value of pi using montecarlo method and visualize the process</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">ntrials</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">ntrials</span><span class="p">)</span>
    <span class="c1"># masking</span>
    <span class="n">inside_circle</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">1</span>
    <span class="n">unit_circle_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">unit_circle</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_circle_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">unit_circle_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">unit_circle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;value of $\pi$=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">inside_circle</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ntrials</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>We are able to write the function <code class="docutils literal notranslate"><span class="pre">mc_pi</span></code> without making use of any explicit <code class="docutils literal notranslate"><span class="pre">for</span></code> loops - thanks to vectorization features in numpy library. Due to a concept called broadcasting in numpy, we are able to subtract a vector from a scalar (1.0 - unit_circle_x**2 ) to compute the y co-ordinate of the unit circle.</p>
<p>Now we will make use of ipywidgets module to pass the parameter interactively to the function <code class="docutils literal notranslate"><span class="pre">mc_pi</span></code>. ipywidgets module provide widgets to generate the UI controls in the notebook itself with which the user can interact. We can drag the slider and observe how the value of pi calculated by mc_pi function changes with the number of trials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">interact_manual</span>

<span class="n">mc_widget</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">mc_pi</span><span class="p">,</span> <span class="n">ntrials</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">mc_widget</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d630b7703238497ea99865b5167af3b4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<section id="svd-and-image-compression">
<h3>SVD and Image compression<a class="headerlink" href="#svd-and-image-compression" title="Permalink to this heading">#</a></h3>
<p>Now we will explore how to apply Singular Value Decomposition of a matrix to the problem of image compression. SVD decomposes a rectangular matrix <span class="math notranslate nohighlight">\(M\)</span> to a three parts.
<span class="math notranslate nohighlight">\(M=U\Sigma V^T\)</span>  -</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(U\)</span> - matrix of left singular vectors in the columns</p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span> - diagonal matrix with singular values</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> - matrix of right singular vectors in the columns</p></li>
</ul>
<p>SVD in effect involves reconstructing the original matrix as a linear combination of several rank one matrices. A rank one matrix can be expressed as a outer product of two column vectors.</p>
<p><span class="math notranslate nohighlight">\(M=\sigma_1u_1v_1^T+\sigma_2u_2v_2^T+\sigma_3u_3v_3^T+\sigma_3u_3v_3^T+....\)</span> .
A matrix of rank r will have r terms of these.</p>
<p>Here <span class="math notranslate nohighlight">\(\sigma_1,\sigma_2,\sigma_3 ...\)</span> are singular values. <span class="math notranslate nohighlight">\(u_1,u_2,u_3 ...\)</span> and <span class="math notranslate nohighlight">\(v_1,v_2,v_3 ...\)</span> are left and right singular vectors respectively.</p>
<p>Image compression using SVD involves taking advantage of the fact that very few of the singular values are large. Although images from the real world are of full rank, they have low effective rank which means that only few of the singular values of the SVD of images will be large.</p>
</section>
<section id="skimage-image-processing-library">
<h3>skimage image processing library<a class="headerlink" href="#skimage-image-processing-library" title="Permalink to this heading">#</a></h3>
<p>We will use skimage image processing library (from sci-kit family of packages) for working with images in python. skimage has a module called data which makes available a set of images for exploration.  We will load some images and convert them into a gray scale format. These images are stored in a python dict object gray_images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">skimage.color</span> <span class="kn">import</span> <span class="n">rgb2gray</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">img_as_ubyte</span><span class="p">,</span> <span class="n">img_as_float</span>

<span class="n">gray_images</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cat&quot;</span><span class="p">:</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chelsea</span><span class="p">())),</span>
    <span class="s2">&quot;astro&quot;</span><span class="p">:</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astronaut</span><span class="p">())),</span>
    <span class="s2">&quot;camera&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">(),</span>
    <span class="s2">&quot;coin&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">coins</span><span class="p">(),</span>
    <span class="s2">&quot;clock&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">clock</span><span class="p">(),</span>
    <span class="s2">&quot;blobs&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">binary_blobs</span><span class="p">(),</span>
    <span class="s2">&quot;coffee&quot;</span><span class="p">:</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">())),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="svd-in-python">
<h3>svd in python<a class="headerlink" href="#svd-in-python" title="Permalink to this heading">#</a></h3>
<p>We will use <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> library’s <code class="docutils literal notranslate"><span class="pre">svd</span></code> function to compute svd of a matrix in python. The svd function returns U,s,V .</p>
<ul class="simple">
<li><p>U has left singular vectors in the columns</p></li>
<li><p>s is rank 1 numpy array with singular values</p></li>
<li><p>V has right singular vectors in the rows -equivalent to <span class="math notranslate nohighlight">\(V^T\)</span> in traditional linear algebra literature</p></li>
</ul>
<p>The reconstructed approximation of the original matrix is done using a subset of singular vectors as below in the <code class="docutils literal notranslate"><span class="pre">compress_svd</span></code> function . We use numpy array slicing to select k singular vectors and values.  Instead of storing <span class="math notranslate nohighlight">\(m\times n\)</span> values for the original image, we can now store <span class="math notranslate nohighlight">\(k(m+n)+k\)</span> values</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>       reconst_matrix = np.dot(U[:,:k],np.dot(np.diag(s[:k]),V[:k,:]))
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">svd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compress_svd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform svd decomposition and truncated (using k singular values/vectors) reconstruction</span>
<span class="sd">    returns</span>
<span class="sd">    --------</span>
<span class="sd">      reconstructed matrix reconst_matrix, array of singular values s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">reconst_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span> <span class="p">:</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="n">k</span><span class="p">]),</span> <span class="n">V</span><span class="p">[:</span><span class="n">k</span><span class="p">,</span> <span class="p">:]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reconst_matrix</span><span class="p">,</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compress-gray-scale-images">
<h3>Compress gray scale images<a class="headerlink" href="#compress-gray-scale-images" title="Permalink to this heading">#</a></h3>
<p>The function <code class="docutils literal notranslate"><span class="pre">compress_show_gray_images</span></code> below takes in the image name (img_name) and number of singular values/vectors(k) to be used in the compressed reconstruction. It also plots the singular values and the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compress_show_gray_images</span><span class="p">(</span><span class="n">img_name</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    compresses gray scale images and display the reconstructed image.</span>
<span class="sd">    Also displays a plot of singular values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">gray_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">reconst_img</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">compress_svd</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">compression_ratio</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">100.0</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;compression ratio=</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compression_ratio</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">reconst_img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compress_show_gray_images</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 451)
</pre></div>
</div>
<img alt="_images/8b340e0346939c9f958cec48cfb81c8be79de53c20da8bdd7a223bc20c95a799.png" src="_images/8b340e0346939c9f958cec48cfb81c8be79de53c20da8bdd7a223bc20c95a799.png" />
</div>
</div>
<p>Use the below interactive widget to explore how the quality of the reconstructed image varies with <span class="math notranslate nohighlight">\(k\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_k_max</span><span class="p">(</span><span class="n">img_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    utility function for calculating max value of the slider range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">gray_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1"># set up the widgets</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="n">list_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">gray_images</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">int_slider_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">compute_k_max</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">update_k_max</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">img_name</span> <span class="o">=</span> <span class="n">list_widget</span><span class="o">.</span><span class="n">value</span>
    <span class="n">int_slider_widget</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">compute_k_max</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>


<span class="n">list_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_k_max</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">compress_show_gray_images</span><span class="p">,</span> <span class="n">img_name</span><span class="o">=</span><span class="n">list_widget</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">int_slider_widget</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a11beee72ac46428843532a14d773d7", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="load-color-images">
<h3>Load color images<a class="headerlink" href="#load-color-images" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_images</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cat&quot;</span><span class="p">:</span> <span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chelsea</span><span class="p">()),</span>
    <span class="s2">&quot;astro&quot;</span><span class="p">:</span> <span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astronaut</span><span class="p">()),</span>
    <span class="s2">&quot;coffee&quot;</span><span class="p">:</span> <span class="n">img_as_float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">()),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compress-color-images">
<h3>Compress color images<a class="headerlink" href="#compress-color-images" title="Permalink to this heading">#</a></h3>
<p>Color images are represented in python as 3 dimensional numpy arrays - the third dimension to represent the color values (red,green blue). However, svd method is applicable to two dimensional matrices. So we have to find a way to convert the 3 dimensional array to 2 dimensional arrays, apply svd and reconstruct it back as a 3 dimensional array . There are two ways to do it. We will show both these methods below .</p>
<ul class="simple">
<li><p>reshape method</p></li>
<li><p>Layer method</p></li>
</ul>
<section id="reshape-method-to-compress-a-color-image">
<h4>Reshape method to compress a color image<a class="headerlink" href="#reshape-method-to-compress-a-color-image" title="Permalink to this heading">#</a></h4>
<p>This method involves flattening the third dimension of the image array into the second dimension using numpy’s reshape method .</p>
<p><code class="docutils literal notranslate"> <span class="pre">image_reshaped</span> <span class="pre">=</span> <span class="pre">image.reshape((original_shape[0],original_shape[1]*3))</span></code></p>
<p>The svd decomposition is applied on the resulting reshaped array and reconstructed with the desired number of singular values/vectors. The image array is reshaped back to the three dimensions by another call to reshape method.</p>
<p><code class="docutils literal notranslate"><span class="pre">image_reconst</span> <span class="pre">=</span> <span class="pre">image_reconst.reshape(original_shape)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compress_show_color_images_reshape</span><span class="p">(</span><span class="n">img_name</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    compress and display the reconstructed color image using the reshape method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">color_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">image_reshaped</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">image_reconst</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">compress_svd</span><span class="p">(</span><span class="n">image_reshaped</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">image_reconst</span> <span class="o">=</span> <span class="n">image_reconst</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">original_shape</span><span class="p">)</span>
    <span class="n">compression_ratio</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">100.0</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;compression ratio=</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compression_ratio</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_reconst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is the interactive widget to explore image compression of color images using the reshape method. By dragging the slider to vary <span class="math notranslate nohighlight">\(k\)</span>, observe how image quality varies. Also, we can explore different images by selecting through the drop down widget.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_k_max_color_images</span><span class="p">(</span><span class="n">img_name</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">color_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">//</span> <span class="p">(</span>
        <span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>


<span class="n">list_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">color_images</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">int_slider_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">compute_k_max_color_images</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">update_k_max_color</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">img_name</span> <span class="o">=</span> <span class="n">list_widget</span><span class="o">.</span><span class="n">value</span>
    <span class="n">int_slider_widget</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">compute_k_max_color_images</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>


<span class="n">list_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_k_max_color</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">compress_show_color_images_reshape</span><span class="p">,</span> <span class="n">img_name</span><span class="o">=</span><span class="n">list_widget</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">int_slider_widget</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c51b5eaba0446c780cb53eaf6eb8d82", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="layers-method-to-compress-color-images">
<h3>Layers method to compress color images<a class="headerlink" href="#layers-method-to-compress-color-images" title="Permalink to this heading">#</a></h3>
<p>In the function <code class="docutils literal notranslate"><span class="pre">compress_show_color_images_layer</span></code>, we treat a color image as a stack of 3 seperate two dimensional images  (Red,blue and green layers) . We apply the truncated svd reconstruction on each two dimensional layer seperately.</p>
<p><code class="docutils literal notranslate"><span class="pre">image_reconst_layers</span> <span class="pre">=</span> <span class="pre">[compress_svd(image[:,:,i],k)[0]</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(3)]</span></code></p>
<p>And we put back the reconstructed layers together.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_reconst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
   <span class="n">image_reconst</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">image_reconst_layers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compress_show_color_images_layer</span><span class="p">(</span><span class="n">img_name</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    compress and display the reconstructed color image using the layer method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">color_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">image_reconst_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">compress_svd</span><span class="p">(</span><span class="n">image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
    <span class="n">image_reconst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">image_reconst</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">image_reconst_layers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">compression_ratio</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">100.0</span>
        <span class="o">*</span> <span class="mi">3</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;compression ratio=</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compression_ratio</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_reconst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is the widget to explore layers method of compressing color images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_k_max_color_images_layers</span><span class="p">(</span><span class="n">img_name</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">color_images</span><span class="p">[</span><span class="n">img_name</span><span class="p">]</span>
    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">//</span> <span class="p">(</span>
        <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">original_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">original_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">list_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">color_images</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">int_slider_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">compute_k_max_color_images_layers</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">update_k_max_color_layers</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">img_name</span> <span class="o">=</span> <span class="n">list_widget</span><span class="o">.</span><span class="n">value</span>
    <span class="n">int_slider_widget</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">compute_k_max_color_images_layers</span><span class="p">(</span><span class="n">img_name</span><span class="p">)</span>


<span class="n">list_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_k_max_color_layers</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">compress_show_color_images_layer</span><span class="p">,</span> <span class="n">img_name</span><span class="o">=</span><span class="n">list_widget</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">int_slider_widget</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "51bbb7aae2fa4b06b4f7cc3354e0e401", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_pca_vs_lda.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Comparison of LDA and PCA</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-on-installation-of-jupyter">A note on installation of jupyter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#montecarlo-calculation-of-pi">Montecarlo calculation of <span class="math notranslate nohighlight">\(\pi\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svd-and-image-compression">SVD and Image compression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skimage-image-processing-library">skimage image processing library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svd-in-python">svd in python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compress-gray-scale-images">Compress gray scale images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-color-images">Load color images</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compress-color-images">Compress color images</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape-method-to-compress-a-color-image">Reshape method to compress a color image</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layers-method-to-compress-color-images">Layers method to compress color images</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mahmood Amintoosi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024. CC0 Licensed - Computer Science Dept., Ferdowsi University of Mashhad.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>